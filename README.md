# 山亞實業 - 自動排班系統

## 專案簡介

這是一個基於 Vue 3 + Vite + Vuetify 開發的自動排班管理系統，用於管理生產機台的操作人員排班，支援多時段、多機台、多人力的複雜排班需求。

## 技術棧

- **前端框架**: Vue 3 (Composition API)
- **構建工具**: Vite
- **UI 框架**: Vuetify 3
- **狀態管理**: Pinia
- **路由**: Vue Router 4
- **HTTP 客戶端**: Axios
- **日期處理**: Day.js
- **Excel 處理**: XLSX
- **樣式**: SCSS

## 已完成功能

### 1. 登入系統
- ✅ 帳號密碼登入驗證
- ✅ 權限控制與授權檢查
- ✅ Session 管理
- ✅ 資料庫連線狀態檢查
- ✅ 停權人員登入阻擋

### 2. 人員管理 (Personnel)
- ✅ 人員資料 CRUD 操作（新增、修改、刪除、查詢）
- ✅ 個人照片上傳功能（支援 gif, png, jpg, jpeg，最大 5MB）
- ✅ 停職/復職管理
- ✅ 權限管理（細粒度權限控制：增、修、刪、查）
- ✅ 搜尋功能（多關鍵字搜尋）
- ✅ 分頁顯示
- ✅ 統計資訊（總人數、啟用中、停職人數）
- ✅ 創建/修改紀錄追蹤

### 3. 機台管理 (Machine)
- ✅ 機台資料 CRUD 操作
- ✅ 機台編號、機台名稱管理
- ✅ 生產優先級設定（方塊、大圈、小圈、大三角、小三角、空白）
- ✅ 週邊機台設定（用於處理人員不合的情況）
- ✅ 執行品號設定（可設定多個品號，由左到右優先判定）
- ✅ 搜尋功能
- ✅ 分頁顯示
- ✅ 優先級顏色標示

### 4. 操作人員管理 (Operator)
- ✅ 操作人員資料 CRUD 操作
- ✅ 人員名稱、性別管理
- ✅ 可上班時段設定（早、中上、中下、晚）- 支援多時段選擇
- ✅ 狀態管理（上班、休假、請假、離職）- 可即時切換
- ✅ 不合對象設定（避免特定人員同時排班）
- ✅ 對應品號設定（技術能力，優先排入對應品號的機台）
- ✅ 搜尋功能
- ✅ 分頁顯示
- ✅ 統計資訊（總人數、上班人數）
- ✅ 時段與狀態的視覺化標示（Chip 標籤）

### 5. 品號資料庫 (ProductCode)
- ✅ 品號資料 CRUD 操作
- ✅ Excel 匯入功能（支援批次匯入）
  - 支援工作表名稱「人力代碼資料表」
  - 自動解析第 5 列標題、第 6 列開始的資料
  - 支援多個人力代碼（逗號、分號、換行分隔）
  - 資料預覽功能
- ✅ 完整品號資訊管理（NO、品號、品名、客戶、鍵檔日期、主機台、副機台、模穴數、週期、模穴重、廠內用料、顏色、分類碼、有無截流塊、有分模、灌包件、專用箱、模具編號、替換模仁、分模編號、備註）
- ✅ 人力代碼管理（支援多個人力代碼）
- ✅ 搜尋功能
- ✅ 分頁顯示

### 6. 排班系統 (Scheduling)

#### 6.1 基礎功能
- ✅ 日期與時段選擇（早、中上、中下、晚）
- ✅ 機台品號輸入（支援下拉選單與手動輸入）
- ✅ 生產優先級設定
- ✅ 備註功能
- ✅ 暫存功能（localStorage，依時段區分）
- ✅ 讀取暫存功能

#### 6.2 自動排班演算法
- ✅ 按生產優先級排序機台
- ✅ 人力代碼解析（手1、手2、手3、自12、自01、自）
- ✅ 可用人員過濾（狀態、時段）
- ✅ 智能人員匹配：
  - 優先匹配精通該品號的人員
  - 考慮不合對象限制
  - 考慮週邊機台衝突
  - 支援共享人力（自12：2人操作3機台）
- ✅ 自動機台識別（全自動機台無需人力）
- ✅ 排班結果統計

#### 6.3 排班結果顯示
- ✅ 三種視圖模式：
  - **表格視圖** (TableView)：傳統表格格式
  - **列表視圖** (ListView)：列表式顯示，分早中晚區域
  - **總覽視圖** (OverviewView)：總覽式顯示
- ✅ 統計資訊卡片：
  - 已排機台數
  - 未排機台數
  - 人力不足/無可用人力
  - 自動機台數
  - 已分配人數
  - 剩餘人力（可展開查看）
- ✅ 剩餘人力顯示（可拖拉至機台）
- ✅ 排班結果編輯（拖拉操作）

#### 6.4 出勤管理
- ✅ 出勤人員管理（AttendanceDrawer）
- ✅ 指定日期時段的出勤人員設定

#### 6.5 資料儲存
- ✅ 排班結果儲存至資料庫
- ✅ 讀取指定日期及時段的排班資料
- ✅ 刪除指定日期及時段的排班資料
- ✅ 自動覆蓋同日期同時段的舊資料

### 7. 共用組件

#### 7.1 PDD 組件庫
- ✅ PDDInput（輸入框）
- ✅ PDDSelect（單選下拉）
- ✅ PDDSelectMulti（多選下拉）
- ✅ PDDSelectSingleString（單選字串）
- ✅ PDDRadio（單選按鈕）
- ✅ PDDCheckboxBoolean（布林值複選框）
- ✅ PDDUpload（檔案上傳）
- ✅ PDDConfirm（確認對話框）
- ✅ PDDDataIterator（資料迭代器）
- ✅ PDDDropdownButton（下拉按鈕）
- ✅ PDDToastMultiV2Pinia（多訊息 Toast）

#### 7.2 其他組件
- ✅ Navbar（導航欄）
- ✅ DatePicker（日期選擇器）
- ✅ FloatingPanel（浮動面板）
- ✅ PaginatedIterator（分頁迭代器）
- ✅ showBigpic（圖片預覽）

### 8. 工具函數

- ✅ `laborCodeParser.js`：人力代碼解析器
  - 解析手1、手2、手3、自12、自01、自等代碼
  - 計算所需人數與機台數
- ✅ `prioritySorter.js`：優先級排序器
  - 按生產優先級排序機台
  - 優先級分組
  - 優先級顏色映射

### 9. 系統功能

- ✅ 權限管理系統（細粒度權限控制）
- ✅ 功能列表（依權限動態顯示）
- ✅ 響應式設計（支援多種螢幕尺寸）
- ✅ 路由守衛（登入狀態檢查）
- ✅ API 統一管理
- ✅ Toast 訊息提示
- ✅ Loading 狀態管理
- ✅ 錯誤處理

## 專案結構

```
shuaya/
├── src/
│   ├── assets/          # 靜態資源
│   │   ├── css/         # 樣式檔案
│   │   ├── img/         # 圖片資源
│   │   └── js/          # JavaScript 工具
│   ├── components/      # 共用組件
│   │   └── PDDComponents/  # PDD 組件庫
│   ├── router/          # 路由配置
│   ├── services/        # 服務層（排班邏輯）
│   ├── stores/          # Pinia 狀態管理
│   ├── utils/           # 工具函數
│   └── views/           # 頁面視圖
│       ├── login/       # 登入頁面
│       └── main/        # 主功能頁面
│           ├── Personnel/     # 人員管理
│           ├── Machine/        # 機台管理
│           ├── Operator/       # 操作人員管理
│           ├── ProductCode/    # 品號資料庫
│           └── Scheduling/     # 排班系統
├── plan/                # 專案規劃文件
└── public/              # 公開資源
```

## 人力代碼說明

- **手1**: 1 人操作 1 機台
- **手2**: 2 人操作 1 機台
- **手3**: 3 人操作 1 機台
- **自12**: 2 人操作 3 機台（共享人力）
- **自01**: 1 人操作 1 機台（自動或 1 人）
- **自**: 全自動，不需要人力

## 生產優先級

由急到不急，共分為六個階段：
1. **方塊** (最高優先)
2. **大圈**
3. **小圈**
4. **大三角**
5. **小三角**
6. **空白** (最低優先)

## 開發指令

```bash
# 安裝依賴
npm install

# 開發模式
npm run dev

# 建置生產版本
npm run build

# 預覽生產版本
npm run preview
```

## 注意事項

1. Excel 匯入功能需要工作表名稱為「人力代碼資料表」
2. Excel 格式：第 5 列為欄位標題，第 6 列開始為資料
3. 排班暫存功能使用 localStorage，依時段區分
4. 圖片上傳限制：最大 5MB，支援 gif, png, jpg, jpeg
5. 系統需要後端 API 支援，請確保後端服務正常運作

## 版本資訊

- **當前版本**: 0.0.1
- **最後更新**: 2025.11.20

## 授權資訊

© 2025.11.16 All Rights Reserved

